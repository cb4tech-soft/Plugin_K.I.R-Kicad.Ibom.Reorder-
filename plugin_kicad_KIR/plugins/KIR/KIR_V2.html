<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.I.R. - Kicad Ibom Reorder</title>
    <link rel="shortcut icon"type="image/x-icon" href="data:image/x-icon;,">


    <!-- Variable globale pour le logo base64 -->
    <script>
        // Remplir cette variable avec le contenu base64 du logo
        // Elle sera utilisée automatiquement dans l'interface et sauvegardée
        const KIR_LOGO_BASE64 = "data:image/webp;base64,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"

        var docHead = document.getElementsByTagName('head')[0];
        var newLink = document.createElement('link');
        newLink.rel = 'shortcut icon';
        newLink.href = KIR_LOGO_BASE64;
        docHead.appendChild(newLink);

        // =====================================================
        // PWA - Progressive Web App Configuration
        // =====================================================
        
        // Créer et injecter le Web App Manifest inline
        const manifest = {
            name: "K.I.R. - Kicad Ibom Reorder",
            short_name: "K.I.R.",
            description: "Outil de réordonnancement des composants IBOM pour KiCad",
            start_url: "./",
            display: "standalone",
            background_color: "#182038",
            theme_color: "#182038",
            orientation: "any",
            icons: [
                {
                    src: KIR_LOGO_BASE64,
                    sizes: "512x512",
                    type: "image/webp",
                    purpose: "any maskable"
                }
            ]
        };
        
        const manifestBlob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
        const manifestURL = URL.createObjectURL(manifestBlob);
        const manifestLink = document.createElement('link');
        manifestLink.rel = 'manifest';
        manifestLink.href = manifestURL;
        docHead.appendChild(manifestLink);

        // Meta tags pour PWA
        const metaThemeColor = document.createElement('meta');
        metaThemeColor.name = 'theme-color';
        metaThemeColor.content = '#182038';
        docHead.appendChild(metaThemeColor);

        const metaAppleMobileWebAppCapable = document.createElement('meta');
        metaAppleMobileWebAppCapable.name = 'apple-mobile-web-app-capable';
        metaAppleMobileWebAppCapable.content = 'yes';
        docHead.appendChild(metaAppleMobileWebAppCapable);

        const metaAppleMobileWebAppStatusBarStyle = document.createElement('meta');
        metaAppleMobileWebAppStatusBarStyle.name = 'apple-mobile-web-app-status-bar-style';
        metaAppleMobileWebAppStatusBarStyle.content = 'black-translucent';
        docHead.appendChild(metaAppleMobileWebAppStatusBarStyle);

        // Apple touch icon
        const appleTouchIcon = document.createElement('link');
        appleTouchIcon.rel = 'apple-touch-icon';
        appleTouchIcon.href = KIR_LOGO_BASE64;
        docHead.appendChild(appleTouchIcon);

        // Service Worker inline pour le mode hors-ligne
        const swCode = `
            const CACHE_NAME = 'kir-cache-v1';
            
            self.addEventListener('install', (event) => {
                self.skipWaiting();
            });
            
            self.addEventListener('activate', (event) => {
                event.waitUntil(clients.claim());
            });
            
            self.addEventListener('fetch', (event) => {
                event.respondWith(
                    fetch(event.request).catch(() => {
                        return caches.match(event.request);
                    })
                );
            });
        `;
        
        const swBlob = new Blob([swCode], { type: 'application/javascript' });
        const swURL = URL.createObjectURL(swBlob);
        
        // Enregistrer le Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register(swURL, { scope: './' })
                .then((registration) => {
                    console.log('K.I.R. Service Worker enregistré avec succès');
                })
                .catch((error) => {
                    console.log('Service Worker non disponible (fichier local ou HTTP):', error.message);
                });
        }

        // =====================================================
        // PWA Installation Logic
        // =====================================================
        let deferredPrompt = null;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Empêcher l'affichage automatique du prompt
            e.preventDefault();
            // Sauvegarder l'événement pour l'utiliser plus tard
            deferredPrompt = e;
            // Afficher le bouton d'installation
            const installBtn = document.getElementById('installBtn');
            if (installBtn) {
                installBtn.style.display = 'flex';
            }
            console.log('K.I.R. peut être installé comme application');
        });

        window.addEventListener('appinstalled', () => {
            // Masquer le bouton après installation
            const installBtn = document.getElementById('installBtn');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
            deferredPrompt = null;
            console.log('K.I.R. a été installé avec succès!');
        });

        // Fonction pour déclencher l'installation
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('Installation acceptée');
                    } else {
                        console.log('Installation refusée');
                    }
                    deferredPrompt = null;
                });
            }
        }
    </script>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --light-bg: #f8f9fa;
            --dark-text: #212529;
            --border-color: #dee2e6;
            --shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: var(--dark-text);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 20px;
            background: #182038;
            color: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo-placeholder {
            width: 120px;
            height: 120px;
            border: 3px dashed rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .logo-placeholder:hover {
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.2);
        }

        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
        }

        .logo-hint {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 4px;
            text-align: center;
        }

        .header-text {
            text-align: left;
            flex: 1;
        }

        .header-text h1 {
            margin: 0 0 10px 0;
            font-size: 2.2rem;
            font-weight: 700;
            color: white;
        }

        .header-text p {
            margin: 0;
            font-size: 1.1rem;
            opacity: 0.9;
            color: white;
        }

        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 5px;
        }

        .lang-btn {
            padding: 5px 10px;
            border: 1px solid var(--border-color);
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .lang-btn:hover {
            border-color: var(--primary-color);
        }

        /* PWA Install Button */
        .install-btn {
            display: none;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
            margin-right: 10px;
        }

        .install-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
            background: linear-gradient(135deg, #218838 0%, #1aa179 100%);
        }

        .install-btn:active {
            transform: translateY(0);
        }

        .install-btn svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .upload-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            text-align: center;
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 40px;
            transition: all 0.3s ease;
            cursor: pointer;
            background: #fafbfc;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background: #f0f8ff;
        }

        .upload-area.dragover {
            border-color: var(--success-color);
            background: #f0fff0;
        }

        .upload-area h3 {
            margin-bottom: 10px;
            color: var(--dark-text);
        }

        .upload-area p {
            color: var(--secondary-color);
        }

        #fileInput {
            display: none;
        }

        .file-info {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 5px;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        .bom-section {
            display: none;
        }

        .bom-section.show {
            display: block;
        }

        .bom-header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .bom-batch-actions {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
            justify-content: center;
            flex-wrap: wrap;
        }

        .batch-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .select-all-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-weight: 500;
        }

        .selection-count {
            font-size: 14px;
            color: var(--secondary-color);
            font-weight: 500;
        }

        .batch-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-outline:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-outline:disabled:hover {
            background-color: transparent;
            color: var(--primary-color);
        }

        .btn-info {
            background-color: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background-color: #138496;
        }

        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .preview-modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .preview-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            max-width: 90vw;
            max-height: 90vh;
            width: 1000px;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }

        .preview-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--light-bg);
        }

        .preview-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .preview-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }

        .preview-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--secondary-color);
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .preview-close:hover {
            background: #f8f9fa;
            color: var(--dark-text);
        }

        .preview-body {
            height: 70vh;
            position: relative;
            padding: 0;
        }

        .preview-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            display: none;
        }

        .preview-iframe.show {
            display: block;
        }

        .preview-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: var(--secondary-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .preview-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .type-selection {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .type-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .btn-type {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            color: #495057;
        }

        .btn-type:hover {
            background-color: #e9ecef;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .custom-type {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .custom-type input {
            padding: 6px 8px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 12px;
            width: 120px;
        }

        .custom-type input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .bom-stats {
            display: flex;
            gap: 20px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: var(--secondary-color);
            font-size: 14px;
        }

        .bom-list {
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .bom-header-row {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid var(--border-color);
            font-weight: bold;
            font-size: 12px;
            color: var(--secondary-color);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .bom-header-row > div {
            padding: 8px;
            text-align: center;
        }

        .bom-header-checkbox { width: 40px; }
        .bom-header-number { width: 50px; }
        .bom-header-content { flex: 1; text-align: left; padding-left: 10px; }
        .bom-header-values { flex: 0 0 150px; }
        .bom-header-actions { width: 60px; }
        .bom-header-drag { width: 20px; }

        .bom-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            cursor: move;
            transition: background-color 0.2s;
        }

        .bom-item.selected {
            background-color: #e3f2fd;
            border-left: 4px solid var(--primary-color);
        }

        .bom-item:last-child {
            border-bottom: none;
        }

        .bom-item:hover {
            background-color: #f8f9fa;
        }

        .bom-item.dragging {
            opacity: 0.5;
            background-color: #e9ecef;
        }

        .bom-item.drop-target {
            background-color: #e8f5e8;
            border: 2px dashed #28a745;
            position: relative;
        }

        .bom-item.drop-target.drop-above::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: #28a745;
            border-radius: 2px;
        }

        .bom-item.drop-target.drop-below::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: #28a745;
            border-radius: 2px;
        }

        .bom-checkbox {
            width: 40px;
            display: flex;
            align-items: center;
        }

        .bom-item-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .bom-number {
            width: 50px;
            font-weight: bold;
            color: var(--primary-color);
            font-size: 16px;
        }

        .bom-content {
            flex: 1;
            font-family: monospace;
            font-size: 14px;
            color: var(--dark-text);
        }

        .bom-values {
            flex: 0 0 150px;
            font-family: monospace;
            font-size: 13px;
            color: var(--secondary-color);
            padding: 0 10px;
            border-left: 1px solid var(--border-color);
            background: rgba(0, 123, 255, 0.05);
        }

        .bom-drag-handle {
            width: 20px;
            height: 20px;
            cursor: grab;
            opacity: 0.5;
            margin-left: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bom-drag-handle:active {
            cursor: grabbing;
        }

        .bom-drag-handle svg {
            width: 16px;
            height: 16px;
        }

        .bom-actions {
            display: flex;
            gap: 5px;
            margin-right: 10px;
        }

        .bom-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            background: #f8f9fa;
            color: #6c757d;
        }

        .bom-btn:hover {
            background: #e9ecef;
            color: #495057;
            transform: scale(1.05);
        }

        .bom-btn:active {
            transform: scale(0.95);
        }

        .bom-btn svg {
            width: 16px;
            height: 16px;
        }

        .bom-btn-start:hover {
            background: #d1ecf1;
            color: #0c5460;
        }

        .bom-btn-end:hover {
            background: #f8d7da;
            color: #721c24;
        }

        .bom-drag-handle:active {
            cursor: grabbing;
        }

        .actions {
            margin-top: 20px;
            text-align: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #545b62;
            transform: translateY(-1px);
        }

        .progress {
            display: none;
            margin-top: 20px;
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress.show {
            display: block;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .alert {
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .alert-info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .help-text {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 6px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .help-header {
            padding: 15px;
            background: #e7f3ff;
            border: none;
            cursor: pointer;
            width: 100%;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 16px;
            font-weight: 500;
            color: #004085;
        }

        .help-header:hover {
            background: #d4edff;
        }

        .help-toggle {
            font-size: 12px;
            transition: transform 0.2s;
        }

        .help-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: white;
        }

        .help-content.show {
            max-height: 500px;
        }

        .help-content-inner {
            padding: 0 15px 15px 15px;
        }

        .help-content-inner h4 {
            color: #004085;
            margin-bottom: 10px;
            margin-top: 15px;
        }

        .help-content-inner ul {
            margin-left: 20px;
        }

        .help-content-inner li {
            margin-bottom: 5px;
        }

        .drag-instruction {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-size: 14px;
            color: #856404;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .bom-item {
                padding: 10px 15px;
            }

            .bom-checkbox {
                width: 30px;
            }

            .bom-number {
                width: 30px;
                font-size: 14px;
            }

            .bom-content {
                font-size: 12px;
            }

            .bom-values {
                flex: 0 0 120px;
                font-size: 12px;
                padding: 0 5px;
            }

            .bom-header-values {
                flex: 0 0 120px;
            }

            .bom-actions {
                gap: 2px;
                margin-right: 5px;
            }

            .bom-btn {
                width: 22px;
                height: 22px;
            }

            .bom-btn svg {
                width: 12px;
                height: 12px;
            }

            .bom-header {
                flex-direction: column;
                align-items: stretch;
            }

            .bom-batch-actions {
                flex-direction: column;
                gap: 10px;
            }

            .batch-controls {
                justify-content: space-between;
            }

            .type-selection {
                width: 100%;
            }

            .type-buttons {
                justify-content: center;
            }

            .custom-type {
                justify-content: center;
            }

            .batch-buttons {
                justify-content: center;
            }

            .bom-stats {
                flex-direction: column;
                gap: 10px;
            }

            .preview-content {
                max-width: 95vw;
                max-height: 95vh;
                width: auto;
            }

            .preview-table {
                font-size: 11px;
            }

            .preview-table th,
            .preview-table td {
                padding: 6px 4px;
            }

            .preview-body {
                height: 80vh;
            }

            .preview-actions {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-selector">
                <button id="installBtn" class="install-btn" onclick="installPWA()" title="Installer K.I.R. comme application">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    <span data-i18n="install">Installer</span>
                </button>
                <button class="lang-btn active" data-lang="fr">FR</button>
                <button class="lang-btn" data-lang="en">EN</button>
            </div>
            <div class="header-content">
                <div class="logo-placeholder" id="logoPlaceholder" title="Cliquez pour ajouter un logo">
                    <script>
                        // Fonction pour afficher le logo de manière sécurisée
                        function displayLogo() {
                            const logoContainer = document.getElementById('logoPlaceholder');
                            if (!logoContainer) return;

                            // Vérifier si le logo est disponible (variable globale ou localStorage)
                            const logoData = (typeof KIR_LOGO_BASE64 !== 'undefined' && KIR_LOGO_BASE64 && KIR_LOGO_BASE64.trim() !== '')
                                ? KIR_LOGO_BASE64
                                : localStorage.getItem('kir-logo');

                            if (logoData && logoData.trim() !== '') {
                                logoContainer.innerHTML = '<img src="' + logoData + '" alt="K.I.R. Logo" style="width: 100%; height: 100%; object-fit: contain; border-radius: 8px;">';
                                logoContainer.style.border = 'none';
                                logoContainer.style.background = 'transparent';
                                logoContainer.style.cursor = 'default';

                                // Mettre à jour la variable globale et le localStorage
                                window.KIR_LOGO_BASE64 = logoData;
                                localStorage.setItem('kir-logo', logoData);
                            } else {
                                logoContainer.innerHTML = '<div class="logo-text">K.I.R.</div><div class="logo-hint">Cliquez pour ajouter</div>';
                            }
                        }

                        // Exécuter immédiatement et aussi après le chargement complet de la page
                        displayLogo();
                        document.addEventListener('DOMContentLoaded', displayLogo);
                    </script>
                </div>
                <div class="header-text">
                    <h1 data-i18n="title">K.I.R. - Kicad Ibom Reorder</h1>
                    <p data-i18n="subtitle">Outil pour réorganiser les lignes d'un BOM Interactive HTML</p>
                </div>
            </div>
        </div>

        <div class="help-text">
            <button class="help-header" id="helpToggle">
                <span data-i18n="help-title">Comment utiliser cet outil</span>
                <span class="help-toggle">▼</span>
            </button>
            <div class="help-content" id="helpContent">
                <div class="help-content-inner">
                    <h4 data-i18n="how-to-use">Comment utiliser cet outil :</h4>
                    <ol>
                        <li data-i18n="step1">Cliquez sur "Choisir un fichier" ou glissez-déposez votre fichier ibom.html</li>
                        <li data-i18n="step2">Les lignes du BOM seront affichées avec références et valeurs des composants</li>
                        <li data-i18n="step3"><strong>Réordonnez</strong> : Cochez plusieurs lignes et utilisez les boutons groupés, OU glissez-déposez individuellement</li>
                        <li data-i18n="step4">Cliquez sur "Exporter le BOM modifié" pour télécharger le fichier</li>
                    </ol>
                    <div class="drag-instruction">
                        <strong data-i18n="tips">💡 Astuces :</strong>
                        <ul style="margin: 5px 0 0 20px; font-size: 13px;">
                            <li data-i18n="tip-multiple">• <strong>Sélection multiple</strong> : Cochez les cases pour sélectionner plusieurs lignes</li>
                            <li data-i18n="tip-analyze">• <strong>Analyser les designators</strong> : Cliquez pour découvrir automatiquement tous les designators présents dans votre BOM</li>
                            <li data-i18n="tip-type">• <strong>Sélection par type</strong> : Cliquez sur un type (R, C, U, etc.) pour sélectionner tous les composants du type</li>
                            <li data-i18n="tip-custom">• <strong>Type personnalisé</strong> : Saisissez un préfixe spécifique pour une sélection personnalisée</li>
                            <li data-i18n="tip-group">• <strong>Actions groupées</strong> : "↑ Au début" et "↓ À la fin" pour déplacer tous les sélectionnés</li>
                            <li data-i18n="tip-drag">• <strong>Drag & drop</strong> : Cliquez et maintenez sur une ligne pour la déplacer précisément</li>
                            <li data-i18n="tip-buttons">• <strong>Boutons individuels</strong> : ↑ et ↓ sur chaque ligne pour des déplacements rapides</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <h3>Importer un fichier BOM</h3>
                <p>Cliquez ici ou glissez-déposez votre fichier ibom.html</p>
                <input type="file" id="fileInput" accept=".html">
            </div>

            <div class="file-info" id="fileInfo">
                <strong>Fichier chargé :</strong> <span id="fileName"></span><br>
                <strong>Taille :</strong> <span id="fileSize"></span>
            </div>
        </div>

        <div class="alert alert-info" id="loadingAlert">
            Analyse du fichier en cours...
        </div>

        <div class="alert alert-success" id="successAlert">
            Fichier analysé avec succès !
        </div>

        <div class="alert alert-error" id="errorAlert">
            Erreur lors de l'analyse du fichier.
        </div>

        <div class="progress" id="progressBar">
            <div class="progress-bar" id="progressBarFill"></div>
        </div>

        <div class="bom-section" id="bomSection">
            <div class="bom-header">
                <div class="bom-stats">
                    <div class="stat">
                        <div class="stat-number" id="totalLines">0</div>
                        <div class="stat-label" data-i18n="total-lines">Lignes totales</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="frontLines">0</div>
                        <div class="stat-label" data-i18n="front-lines">Face avant</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="backLines">0</div>
                        <div class="stat-label" data-i18n="back-lines">Face arrière</div>
                    </div>
                </div>
                <div class="bom-batch-actions">
                    <div class="batch-controls">
                        <label class="select-all-label">
                            <input type="checkbox" id="selectAllCheckbox">
                            <span data-i18n="select-all">Tout sélectionner</span>
                        </label>
                        <span class="selection-count" id="selectionCount">0 sélectionné(s)</span>
                    </div>
                    <div class="type-selection" id="typeSelection">
                        <div class="type-buttons" id="typeButtons">
                            <button class="btn btn-sm btn-secondary" id="analyzeTypesBtn">Analyser les designators du BOM</button>
                        </div>
                        <div class="custom-type" id="customTypeSection" style="display: none;">
                            <input type="text" id="customTypeInput" data-i18n="custom-type-placeholder" placeholder="Type personnalisé (ex: JP)" maxlength="10">
                            <button class="btn btn-sm btn-primary" id="selectCustomTypeBtn" data-i18n="select">Sélectionner</button>
                        </div>
                    </div>
                    <div class="batch-buttons">
                        <button class="btn btn-outline" id="moveSelectedToStartBtn" disabled data-i18n="move-to-start">
                            ↑ Au début
                        </button>
                        <button class="btn btn-outline" id="moveSelectedToEndBtn" disabled data-i18n="move-to-end">
                            ↓ À la fin
                        </button>
                    </div>
                </div>
                <div class="actions">
                    <button class="btn btn-info" id="previewBtn" data-i18n="preview">Aperçu</button>
                    <button class="btn btn-secondary" id="resetBtn" data-i18n="reset">Réinitialiser</button>
                    <button class="btn btn-success" id="exportBtn" data-i18n="export">Exporter le BOM modifié</button>
                </div>
            </div>

            <div class="bom-list" id="bomList">
                <div class="bom-header-row">
                    <div class="bom-header-checkbox"></div>
                    <div class="bom-header-number">N°</div>
                    <div class="bom-header-content" data-i18n="references">Références</div>
                    <div class="bom-header-values" data-i18n="values">Valeurs</div>
                    <div class="bom-header-actions"></div>
                    <div class="bom-header-drag"></div>
                </div>
                <!-- Les éléments du BOM seront insérés ici -->
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="preview-modal" id="previewModal">
        <div class="preview-content">
            <div class="preview-header">
                <h3 class="preview-title" data-i18n="preview-title">Aperçu graphique du BOM</h3>
                <div class="preview-actions">
                    <button class="btn btn-sm btn-outline" id="previewRefresh" data-i18n="refresh">Actualiser</button>
                    <button class="btn btn-sm btn-outline" id="previewFullscreen" data-i18n="fullscreen">Plein écran</button>
                    <button class="preview-close" id="previewClose">&times;</button>
                </div>
            </div>
            <div class="preview-body">
                <iframe id="previewFrame" class="preview-iframe" sandbox="allow-scripts allow-same-origin"></iframe>
                <div class="preview-loading" id="previewLoading">
                    <div class="preview-spinner"></div>
                    <p data-i18n="generating-preview">Génération de l'aperçu...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/lz-string@1.4.4/libs/lz-string.min.js"></script>
    <script>
        class BOMReorder {
            constructor() {
                this.pcbdata = null;
                this.originalData = null;
                this.originalFileContent = null;
                this.draggedElement = null;
                this.placeholder = null;
                this.dragIndex = null;
                this.selectedItems = new Set();
                this.currentLang = 'fr';

                // Translations
                this.translations = {
                    fr: {
                        title: "K.I.R. - Kicad Ibom Reorder",
                        subtitle: "Outil pour réorganiser les lignes d'un BOM Interactive HTML",
                        'help-title': "Comment utiliser cet outil",
                        'how-to-use': "Comment utiliser cet outil :",
                        step1: "Cliquez sur \"Choisir un fichier\" ou glissez-déposez votre fichier ibom.html",
                        step2: "Les lignes du BOM seront affichées avec références et valeurs des composants",
                        step3: "<strong>Réordonnez</strong> : Cochez plusieurs lignes et utilisez les boutons groupés, OU glissez-déposez individuellement",
                        step4: "Cliquez sur \"Exporter le BOM modifié\" pour télécharger le fichier",
                        tips: "💡 Astuces :",
                        'tip-multiple': "• <strong>Sélection multiple</strong> : Cochez les cases pour sélectionner plusieurs lignes",
                        'tip-analyze': "• <strong>Analyser les designators</strong> : Cliquez pour découvrir automatiquement tous les designators présents dans votre BOM",
                        'tip-type': "• <strong>Sélection par type</strong> : Cliquez sur un type (R, C, U, etc.) pour sélectionner tous les composants du type",
                        'tip-custom': "• <strong>Type personnalisé</strong> : Saisissez un préfixe spécifique pour une sélection personnalisée",
                        'tip-group': "• <strong>Actions groupées</strong> : \"↑ Au début\" et \"↓ À la fin\" pour déplacer tous les sélectionnés",
                        'tip-drag': "• <strong>Drag & drop</strong> : Cliquez et maintenez sur une ligne pour la déplacer précisément",
                        'tip-buttons': "• <strong>Boutons individuels</strong> : ↑ et ↓ sur chaque ligne pour des déplacements rapides",
                        'total-lines': "Lignes totales",
                        'front-lines': "Face avant",
                        'back-lines': "Face arrière",
                        'select-all': "Tout sélectionner",
                        'selected-count': "sélectionné(s)",
                        'move-to-start': "↑ Au début",
                        'move-to-end': "↓ À la fin",
                        'reset': "Réinitialiser",
                        'export': "Exporter le BOM modifié",
                        'analyzing': "Analyse du fichier en cours...",
                        'analyzed': "Fichier analysé avec succès !",
                        'error': "Erreur lors de l'analyse du fichier.",
                        'export-success': "Fichier exporté avec succès !",
                        'reset-confirm': "Êtes-vous sûr de vouloir réinitialiser le BOM à son état original ?",
                        'designators-found': "designators trouvés dans ce BOM !",
                        'no-components': "Aucun composant trouvé pour le type",
                        'components-selected': "composants de type",
                        'custom-type-placeholder': "Type personnalisé (ex: JP)",
                        'select': "Sélectionner",
                        'references': "Références",
                        'values': "Valeurs",
                        'preview': "Aperçu",
                        'preview-title': "K.I.R. - Aperçu graphique du BOM",
                        'refresh': "Actualiser",
                        'fullscreen': "Plein écran",
                        'generating-preview': "Génération de l'aperçu...",
                        'install': "Installer"
                    },
                    en: {
                        title: "K.I.R. - Kicad Ibom Reorder",
                        subtitle: "Tool to reorganize lines in an Interactive HTML BOM",
                        'help-title': "How to use this tool",
                        'how-to-use': "How to use this tool:",
                        step1: "Click \"Choose file\" or drag and drop your ibom.html file",
                        step2: "BOM lines will be displayed with component references and values",
                        step3: "<strong>Reorder</strong>: Check multiple lines and use group buttons, OR drag and drop individually",
                        step4: "Click \"Export Modified BOM\" to download the file",
                        tips: "💡 Tips:",
                        'tip-multiple': "• <strong>Multiple selection</strong>: Check boxes to select multiple lines",
                        'tip-analyze': "• <strong>Analyze designators</strong>: Click to automatically discover all designators present in your BOM",
                        'tip-type': "• <strong>Select by type</strong>: Click on a type (R, C, U, etc.) to select all components of that type",
                        'tip-custom': "• <strong>Custom type</strong>: Enter a specific prefix for custom selection",
                        'tip-group': "• <strong>Group actions</strong>: \"↑ To start\" and \"↓ To end\" to move all selected items",
                        'tip-drag': "• <strong>Drag & drop</strong>: Click and hold on a line to move it precisely",
                        'tip-buttons': "• <strong>Individual buttons</strong>: ↑ and ↓ on each line for quick moves",
                        'total-lines': "Total lines",
                        'front-lines': "Front side",
                        'back-lines': "Back side",
                        'select-all': "Select all",
                        'selected-count': "selected",
                        'move-to-start': "↑ To start",
                        'move-to-end': "↓ To end",
                        'reset': "Reset",
                        'export': "Export Modified BOM",
                        'analyzing': "File analysis in progress...",
                        'analyzed': "File analyzed successfully!",
                        'error': "Error analyzing the file.",
                        'export-success': "File exported successfully!",
                        'reset-confirm': "Are you sure you want to reset the BOM to its original state?",
                        'designators-found': "designators found in this BOM!",
                        'no-components': "No components found for type",
                        'components-selected': "components of type",
                        'custom-type-placeholder': "Custom type (ex: JP)",
                        'select': "Select",
                        'references': "References",
                        'values': "Values",
                        'preview': "Preview",
                        'preview-title': "K.I.R. - BOM Graphical Preview",
                        'refresh': "Refresh",
                        'fullscreen': "Fullscreen",
                        'generating-preview': "Generating preview...",
                        'install': "Install"
                    }
                };

                this.init();
            }

            init() {
                this.bindEvents();
                this.bindLanguageEvents();
                this.bindHelpEvents();
                this.updateLanguage();
            }

            bindEvents() {
                const uploadArea = document.getElementById('uploadArea');
                const fileInput = document.getElementById('fileInput');
                const exportBtn = document.getElementById('exportBtn');
                const resetBtn = document.getElementById('resetBtn');

                // Upload events
                uploadArea.addEventListener('click', () => fileInput.click());
                fileInput.addEventListener('change', (e) => this.handleFileSelect(e));

                // Drag & drop events
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });
                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.classList.remove('dragover');
                });
                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.handleFile(files[0]);
                    }
                });

                // Action buttons
                const previewBtn = document.getElementById('previewBtn');
                if (previewBtn) {
                    previewBtn.addEventListener('click', () => this.showPreview());
                }
                exportBtn.addEventListener('click', () => this.exportBOM());
                resetBtn.addEventListener('click', () => this.resetBOM());

                // Selection events
                this.bindSelectionEvents();
            }

            bindSelectionEvents() {
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');
                const moveSelectedToStartBtn = document.getElementById('moveSelectedToStartBtn');
                const moveSelectedToEndBtn = document.getElementById('moveSelectedToEndBtn');
                const analyzeTypesBtn = document.getElementById('analyzeTypesBtn');
                const selectCustomTypeBtn = document.getElementById('selectCustomTypeBtn');

                if (selectAllCheckbox) {
                    selectAllCheckbox.addEventListener('change', (e) => this.toggleSelectAll(e.target.checked));
                }

                if (moveSelectedToStartBtn) {
                    moveSelectedToStartBtn.addEventListener('click', () => this.moveSelectedToStart());
                }

                if (moveSelectedToEndBtn) {
                    moveSelectedToEndBtn.addEventListener('click', () => this.moveSelectedToEnd());
                }

                if (analyzeTypesBtn) {
                    analyzeTypesBtn.addEventListener('click', () => this.analyzeAndShowTypes());
                }

                if (selectCustomTypeBtn) {
                    selectCustomTypeBtn.addEventListener('click', () => this.selectCustomType());
                }

                // Bind type selection buttons
                this.bindTypeButtons();
            }

            bindTypeButtons() {
                const typeButtons = document.querySelectorAll('.btn-type');
                typeButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        const type = e.target.dataset.type;
                        if (type) {
                            this.selectByType(type);
                        }
                    });
                });
            }

            handleFileSelect(e) {
                const file = e.target.files[0];
                if (file) {
                    this.handleFile(file);
                }
            }

            handleFile(file) {
                if (!file.name.endsWith('.html')) {
                    this.showError('Veuillez sélectionner un fichier HTML valide.');
                    return;
                }

                this.showLoading();
                this.updateFileInfo(file);

                const reader = new FileReader();
                reader.onload = (e) => this.parseBOMFile(e.target.result);
                reader.readAsText(file);
            }

            updateFileInfo(file) {
                const fileInfo = document.getElementById('fileInfo');
                const fileName = document.getElementById('fileName');
                const fileSize = document.getElementById('fileSize');

                fileName.textContent = file.name;
                fileSize.textContent = this.formatFileSize(file.size);
                fileInfo.classList.add('show');
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            parseBOMFile(content) {
                try {
                    this.originalFileContent = content; // Store original content

                    // Extract compressed data
                    const match = content.match(/LZString\.decompressFromBase64\("([^"]+)"\)/);
                    if (!match) {
                        throw new Error('Données compressées non trouvées dans le fichier.');
                    }

                    const compressedData = match[1];
                    const decompressed = LZString.decompressFromBase64(compressedData);
                    this.pcbdata = JSON.parse(decompressed);
                    this.originalData = JSON.parse(JSON.stringify(this.pcbdata)); // Deep copy

                    this.updateProgress(100);
                    this.hideLoading();
                    this.showSuccess();
                    this.displayBOM();

                } catch (error) {
                    console.error('Erreur lors de l\'analyse:', error);
                    this.hideLoading();
                    this.showError('Erreur lors de l\'analyse du fichier: ' + error.message);
                }
            }

            displayBOM() {
                const bomSection = document.getElementById('bomSection');
                const bomList = document.getElementById('bomList');
                const totalLines = document.getElementById('totalLines');
                const frontLines = document.getElementById('frontLines');
                const backLines = document.getElementById('backLines');

                // Update stats
                totalLines.textContent = this.pcbdata.bom.both.length;
                frontLines.textContent = this.pcbdata.bom.F.length;
                backLines.textContent = this.pcbdata.bom.B.length;

                // Clear existing list
                bomList.innerHTML = '';

                // Reset selection
                this.selectedItems.clear();
                this.updateSelectionUI();

                // Add BOM items
                this.pcbdata.bom.both.forEach((item, index) => {
                    const bomItem = this.createBOMItem(item, index);
                    bomList.appendChild(bomItem);
                });

                bomSection.classList.add('show');
                bomSection.classList.add('show');
                this.bindDragEvents();
                this.bindButtonEvents();

                // Re-bind type buttons after DOM update
                this.bindTypeButtons();
            }

            createBOMItem(item, index) {
                const bomItem = document.createElement('div');
                bomItem.className = 'bom-item';
                bomItem.dataset.index = index;
                bomItem.draggable = true;

                bomItem.innerHTML = `
                    <div class="bom-checkbox">
                        <input type="checkbox" class="bom-item-checkbox" data-index="${index}">
                    </div>
                    <div class="bom-number">${index + 1}</div>
                    <div class="bom-content">${this.formatBOMContent(item)}</div>
                    <div class="bom-values">${this.formatBOMValues(item)}</div>
                    <div class="bom-actions">
                        <button class="bom-btn bom-btn-start" title="Déplacer au début" data-action="move-to-start">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7 14l5-5 5 5z"/>
                                <path d="M0 0h24v24H0z" fill="none"/>
                            </svg>
                        </button>
                        <button class="bom-btn bom-btn-end" title="Déplacer à la fin" data-action="move-to-end">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7 10l5 5 5-5z"/>
                                <path d="M0 0h24v24H0z" fill="none"/>
                            </svg>
                        </button>
                    </div>
                    <div class="bom-drag-handle">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 15h18v-2H3v2zm0 4h18v-2H3v2zm0-8h18V9H3v2zm0-6v2h18V5H3z"/>
                        </svg>
                    </div>
                `;

                return bomItem;
            }

            formatBOMContent(item) {
                if (!Array.isArray(item)) return 'N/A';

                return item.map(ref => {
                    const [refName, footprintId] = ref;
                    return `${refName}`;
                }).join(', ');
            }

            formatBOMValues(item) {
                if (!Array.isArray(item)) return '';

                // In KiCAD BOMs, Value is typically at index 0
                const valueIndex = 0;

                return this.formatBOMValuesWithIndex(item, valueIndex);
            }

            formatBOMValuesWithIndex(item, valueIndex) {
                // Collect unique values
                const values = new Set();

                item.forEach(ref => {
                    if (Array.isArray(ref) && ref[1] !== undefined) {
                        const componentId = ref[1];
                        if (this.pcbdata.bom.fields && this.pcbdata.bom.fields[componentId]) {
                            const fieldData = this.pcbdata.bom.fields[componentId];
                            if (Array.isArray(fieldData) && fieldData[valueIndex]) {
                                const value = fieldData[valueIndex];
                                if (value && value.trim()) {
                                    values.add(value.trim());
                                }
                            }
                        }
                    }
                });

                const uniqueValues = Array.from(values);
                if (uniqueValues.length === 0) return '';

                // If all values are the same, show just one
                if (uniqueValues.length === 1) {
                    return uniqueValues[0];
                }

                // If multiple different values, show them separated
                return uniqueValues.slice(0, 3).join(', ') + (uniqueValues.length > 3 ? '...' : '');
            }

            bindDragEvents() {
                const bomList = document.getElementById('bomList');

                // Use event delegation for better performance and reliability
                bomList.addEventListener('dragstart', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem && !e.target.closest('.bom-drag-handle')) {
                        this.handleDragStart(e);
                    }
                });

                bomList.addEventListener('dragend', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem) {
                        this.handleDragEnd(e);
                    }
                });

                bomList.addEventListener('dragover', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem) {
                        this.handleDragOver(e);
                    }
                });

                bomList.addEventListener('dragenter', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem) {
                        this.handleDragEnter(e);
                    }
                });

                bomList.addEventListener('dragleave', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem) {
                        this.handleDragLeave(e);
                    }
                });

                bomList.addEventListener('drop', (e) => {
                    const bomItem = e.target.closest('.bom-item');
                    if (bomItem) {
                        this.handleDrop(e);
                    }
                });
            }

            bindButtonEvents() {
                const bomList = document.getElementById('bomList');

                bomList.addEventListener('click', (e) => {
                    const button = e.target.closest('.bom-btn');
                    const checkbox = e.target.closest('.bom-item-checkbox');

                    if (button) {
                        e.preventDefault();
                        const bomItem = button.closest('.bom-item');
                        const action = button.dataset.action;

                        if (action === 'move-to-start') {
                            this.moveToStart(bomItem);
                        } else if (action === 'move-to-end') {
                            this.moveToEnd(bomItem);
                        }
                    } else if (checkbox) {
                        // Handle checkbox clicks
                        const bomItem = checkbox.closest('.bom-item');
                        setTimeout(() => this.toggleItemSelection(bomItem), 0);
                    }
                });
            }

            moveToStart(bomItem) {
                const bomList = document.getElementById('bomList');
                const firstItem = bomList.querySelector('.bom-item');

                if (bomItem !== firstItem) {
                    bomList.insertBefore(bomItem, firstItem);
                    this.updateBOMOrder();
                }
            }

            moveToEnd(bomItem) {
                const bomList = document.getElementById('bomList');

                // Move to the end
                bomList.appendChild(bomItem);
                this.updateBOMOrder();
            }

            toggleItemSelection(bomItem) {
                const checkbox = bomItem.querySelector('.bom-item-checkbox');
                if (checkbox) {
                    const index = parseInt(checkbox.dataset.index);
                    if (checkbox.checked) {
                        this.selectedItems.add(index);
                        bomItem.classList.add('selected');
                    } else {
                        this.selectedItems.delete(index);
                        bomItem.classList.remove('selected');
                    }
                    this.updateSelectionUI();
                }
            }

            toggleSelectAll(selectAll) {
                const checkboxes = document.querySelectorAll('.bom-item-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = selectAll;
                    const bomItem = checkbox.closest('.bom-item');
                    const index = parseInt(checkbox.dataset.index);

                    if (selectAll) {
                        this.selectedItems.add(index);
                        bomItem.classList.add('selected');
                    } else {
                        this.selectedItems.delete(index);
                        bomItem.classList.remove('selected');
                    }
                });
                this.updateSelectionUI();
            }

            updateSelectionUI() {
                const selectionCount = document.getElementById('selectionCount');
                const moveSelectedToStartBtn = document.getElementById('moveSelectedToStartBtn');
                const moveSelectedToEndBtn = document.getElementById('moveSelectedToEndBtn');
                const selectAllCheckbox = document.getElementById('selectAllCheckbox');

                const count = this.selectedItems.size;
                selectionCount.textContent = count + ' sélectionné(s)';

                const hasSelection = count > 0;
                moveSelectedToStartBtn.disabled = !hasSelection;
                moveSelectedToEndBtn.disabled = !hasSelection;

                // Update select all checkbox state
                const totalItems = document.querySelectorAll('.bom-item-checkbox').length;
                const checkedItems = document.querySelectorAll('.bom-item-checkbox:checked').length;

                if (checkedItems === 0) {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = false;
                } else if (checkedItems === totalItems) {
                    selectAllCheckbox.checked = true;
                    selectAllCheckbox.indeterminate = false;
                } else {
                    selectAllCheckbox.checked = false;
                    selectAllCheckbox.indeterminate = true;
                }
            }

            moveSelectedToStart() {
                if (this.selectedItems.size === 0) return;

                const bomList = document.getElementById('bomList');

                // Collect all selected DOM elements first
                const selectedElements = [];
                this.selectedItems.forEach(index => {
                    const bomItem = bomList.querySelector(`.bom-item-checkbox[data-index="${index}"]`).closest('.bom-item');
                    if (bomItem) {
                        selectedElements.push(bomItem);
                    }
                });

                // Collect all non-selected elements (in their current order)
                const allItems = Array.from(bomList.querySelectorAll('.bom-item'));
                const nonSelectedElements = allItems.filter(item => {
                    const checkbox = item.querySelector('.bom-item-checkbox');
                    const index = parseInt(checkbox.dataset.index);
                    return !this.selectedItems.has(index);
                });

                // New order: selected items first, then non-selected items
                const newOrder = [...selectedElements, ...nonSelectedElements];

                // Clear and rebuild the list
                bomList.innerHTML = '';
                newOrder.forEach(item => bomList.appendChild(item));

                this.updateBOMOrder();

                // Clear selection after move
                this.selectedItems.clear();
                this.updateSelectionUI();
            }

            moveSelectedToEnd() {
                if (this.selectedItems.size === 0) return;

                const bomList = document.getElementById('bomList');

                // Collect all selected DOM elements first
                const selectedElements = [];
                this.selectedItems.forEach(index => {
                    const bomItem = bomList.querySelector(`.bom-item-checkbox[data-index="${index}"]`).closest('.bom-item');
                    if (bomItem) {
                        selectedElements.push(bomItem);
                    }
                });

                // Collect all non-selected elements (in their current order)
                const allItems = Array.from(bomList.querySelectorAll('.bom-item'));
                const nonSelectedElements = allItems.filter(item => {
                    const checkbox = item.querySelector('.bom-item-checkbox');
                    const index = parseInt(checkbox.dataset.index);
                    return !this.selectedItems.has(index);
                });

                // New order: non-selected items first, then selected items
                const newOrder = [...nonSelectedElements, ...selectedElements];

                // Clear and rebuild the list
                bomList.innerHTML = '';
                newOrder.forEach(item => bomList.appendChild(item));

                this.updateBOMOrder();

                // Clear selection after move
                this.selectedItems.clear();
                this.updateSelectionUI();
            }

            analyzeAndShowTypes() {
                const typeButtons = document.getElementById('typeButtons');
                const customTypeSection = document.getElementById('customTypeSection');

                // Analyze BOM to find all reference types
                const types = new Set();
                this.pcbdata.bom.both.forEach((item, index) => {
                    if (Array.isArray(item)) {
                        item.forEach(ref => {
                            if (Array.isArray(ref) && ref[0]) {
                                // Extract the type (letters before numbers)
                                const match = ref[0].match(/^([A-Za-z]+)/);
                                if (match) {
                                    types.add(match[1]);
                                }
                            }
                        });
                    }
                });

                // Create buttons for each type found
                const sortedTypes = Array.from(types).sort();
                let buttonsHtml = '';

                sortedTypes.forEach(type => {
                    buttonsHtml += `<button class="btn btn-sm btn-type" data-type="${type}" title="Sélectionner tous les composants ${type}">${type}</button>`;
                });

                buttonsHtml += '<button class="btn btn-sm btn-secondary" id="analyzeTypesBtn">Analyser les designators du BOM</button>';

                typeButtons.innerHTML = buttonsHtml;

                // Show custom type section
                customTypeSection.style.display = 'flex';

                // Re-bind events
                this.bindTypeButtons();
                document.getElementById('analyzeTypesBtn').addEventListener('click', () => this.analyzeAndShowTypes());

                this.showSuccess(sortedTypes.length + ' ' + this.translations[this.currentLang]['designators-found']);
            }

            selectByType(type) {
                const bomList = document.getElementById('bomList');

                // Clear current selection
                this.selectedItems.clear();

                // Find all items that start with the specified type
                const checkboxes = bomList.querySelectorAll('.bom-item-checkbox');
                checkboxes.forEach(checkbox => {
                    const item = checkbox.closest('.bom-item');
                    const itemData = this.pcbdata.bom.both[parseInt(checkbox.dataset.index)];

                    if (Array.isArray(itemData)) {
                        const hasType = itemData.some(ref => {
                            if (Array.isArray(ref) && ref[0]) {
                                return ref[0].startsWith(type);
                            }
                            return false;
                        });

                        if (hasType) {
                            checkbox.checked = true;
                            this.selectedItems.add(parseInt(checkbox.dataset.index));
                            item.classList.add('selected');
                        } else {
                            checkbox.checked = false;
                            item.classList.remove('selected');
                        }
                    }
                });

                this.updateSelectionUI();

                const count = this.selectedItems.size;
                if (count > 0) {
                    this.showSuccess(count + ' ' + this.translations[this.currentLang]['components-selected'] + ' \'' + type + '\' !');
                } else {
                    this.showError(this.translations[this.currentLang]['no-components'] + ' \'' + type + '\'');
                }
            }

            selectCustomType() {
                const customTypeInput = document.getElementById('customTypeInput');
                const type = customTypeInput.value.trim().toUpperCase();

                if (!type) {
                    this.showError('Veuillez saisir un type de composant');
                    return;
                }

                this.selectByType(type);
                customTypeInput.value = '';
            }

            handleDragStart(e) {
                this.draggedElement = e.target.closest('.bom-item');
                if (!this.draggedElement) return;

                this.dragIndex = parseInt(this.draggedElement.dataset.index);
                this.draggedElement.classList.add('dragging');

                // Set drag data
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/html', this.draggedElement.outerHTML);
            }

            handleDragEnd(e) {
                if (!this.draggedElement) return;

                this.draggedElement.classList.remove('dragging');

                // Remove drop target styling
                document.querySelectorAll('.bom-item.drop-target').forEach(item => {
                    item.classList.remove('drop-target', 'drop-above', 'drop-below');
                });

                this.draggedElement = null;
                // Note: updateBOMOrder is called in handleDrop
            }

            handleDragOver(e) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            }

            handleDragEnter(e) {
                e.preventDefault();
                const target = e.target.closest('.bom-item');

                if (!target || target === this.draggedElement) {
                    return;
                }

                // Remove previous drop target styling
                document.querySelectorAll('.bom-item.drop-target').forEach(item => {
                    item.classList.remove('drop-target', 'drop-above', 'drop-below');
                });

                // Determine drop position
                const rect = target.getBoundingClientRect();
                const midpoint = rect.top + rect.height / 2;

                target.classList.add('drop-target');
                if (e.clientY < midpoint) {
                    target.classList.add('drop-above');
                } else {
                    target.classList.add('drop-below');
                }
            }

            handleDragLeave(e) {
                const target = e.target.closest('.bom-item');
                if (target && target !== e.relatedTarget?.closest('.bom-item')) {
                    target.classList.remove('drop-target', 'drop-above', 'drop-below');
                }
            }

            handleDrop(e) {
                e.preventDefault();

                const target = e.target.closest('.bom-item');
                if (!target || target === this.draggedElement) {
                    return;
                }


                // Determine where to insert
                const rect = target.getBoundingClientRect();
                const midpoint = rect.top + rect.height / 2;
                const insertBefore = e.clientY < midpoint;

                // Move the dragged element
                const parent = target.parentNode;
                if (insertBefore) {
                    parent.insertBefore(this.draggedElement, target);
                } else {
                    parent.insertBefore(this.draggedElement, target.nextSibling);
                }

                // Clean up styling
                document.querySelectorAll('.bom-item.drop-target').forEach(item => {
                    item.classList.remove('drop-target', 'drop-above', 'drop-below');
                });

                console.log('Element moved, updating order...');
                this.updateBOMOrder();
            }

            updateBOMOrder() {
                const bomList = document.getElementById('bomList');
                const items = Array.from(bomList.querySelectorAll('.bom-item:not(.placeholder)'));

                // The DOM order now represents the new order, so we need to map the current positions
                // to the original data indices, then reorder the data array
                const currentOrder = items.map(item => parseInt(item.dataset.index));
                const newDataOrder = currentOrder.map(originalIndex => this.pcbdata.bom.both[originalIndex]);

                this.pcbdata.bom.both = newDataOrder;

                // Synchronize F and B arrays with the new both order
                this.syncViewArrays();

                // Update the dataset indices to reflect the new positions
                items.forEach((item, newIndex) => {
                    item.dataset.index = newIndex;
                    const numberElement = item.querySelector('.bom-number');
                    const checkbox = item.querySelector('.bom-item-checkbox');

                    if (numberElement) {
                        numberElement.textContent = newIndex + 1;
                    }
                    if (checkbox) {
                        checkbox.dataset.index = newIndex;
                    }
                });

            }

            syncViewArrays() {
                // Synchronize F and B arrays with the reordered both array
                // Since F and B are subsets of both, we need to update their order

                if (!this.pcbdata.bom.F || !this.pcbdata.bom.B || !this.pcbdata.bom.both) {
                    console.log('Missing BOM arrays, skipping sync');
                    return;
                }

                // Create a mapping from component ID to its position in the new both array
                const componentPositionMap = new Map();

                this.pcbdata.bom.both.forEach((group, groupIndex) => {
                    group.forEach(ref => {
                        if (Array.isArray(ref) && ref[1] !== undefined) {
                            componentPositionMap.set(ref[1], groupIndex);
                        }
                    });
                });

                // Reorder F array to match the new both order
                if (this.pcbdata.bom.F.length > 0) {
                    this.pcbdata.bom.F.sort((groupA, groupB) => {
                        // Find the position of the first component in each group
                        const posA = this.getGroupPosition(groupA, componentPositionMap);
                        const posB = this.getGroupPosition(groupB, componentPositionMap);
                        return posA - posB;
                    });
                }

                // Reorder B array to match the new both order
                if (this.pcbdata.bom.B.length > 0) {
                    this.pcbdata.bom.B.sort((groupA, groupB) => {
                        const posA = this.getGroupPosition(groupA, componentPositionMap);
                        const posB = this.getGroupPosition(groupB, componentPositionMap);
                        return posA - posB;
                    });
                }

                console.log('View arrays synchronized with new both order');
            }

            getGroupPosition(group, positionMap) {
                // Return the position of the first component found in this group
                for (const ref of group) {
                    if (Array.isArray(ref) && ref[1] !== undefined) {
                        const position = positionMap.get(ref[1]);
                        if (position !== undefined) {
                            return position;
                        }
                    }
                }
                return 999999; // If no component found, put at the end
            }

            exportBOM() {
                try {
                    if (!this.originalFileContent) {
                        throw new Error('Contenu original du fichier non disponible.');
                    }

                    // Compress the modified data
                    const jsonString = JSON.stringify(this.pcbdata);
                    const compressed = LZString.compressToBase64(jsonString);

                    // Replace compressed data in original content
                    const newContent = this.originalFileContent.replace(
                        /LZString\.decompressFromBase64\("([^"]+)"\)/,
                        'LZString.decompressFromBase64("' + compressed + '")'
                    );

                    // Close preview and download the file
                    this.hidePreview();
                    this.downloadFile(newContent, 'bom_modified.html');
                    this.showSuccess(this.translations[this.currentLang]['export-success']);

                } catch (error) {
                    console.error('Erreur lors de l\'export:', error);
                    this.showError('Erreur lors de l\'export: ' + error.message);
                }
            }


            async downloadFile(content, filename) {
                const blob = new Blob([content], { type: 'text/html' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);

                URL.revokeObjectURL(url);
            }

            resetBOM() {
                if (confirm(this.translations[this.currentLang]['reset-confirm'])) {
                    this.hidePreview(); // Close preview if open
                    this.pcbdata = JSON.parse(JSON.stringify(this.originalData));
                    this.selectedItems.clear();
                    this.displayBOM();
                }
            }

            showLoading() {
                const alert = document.getElementById('loadingAlert');
                alert.textContent = this.translations[this.currentLang]['analyzing'];
                alert.classList.add('show');
                document.getElementById('progressBar').classList.add('show');
                this.updateProgress(0);
            }

            hideLoading() {
                document.getElementById('loadingAlert').classList.remove('show');
                document.getElementById('progressBar').classList.remove('show');
            }

            showSuccess(message) {
                const alert = document.getElementById('successAlert');
                alert.textContent = message || this.translations[this.currentLang]['analyzed'];
                alert.classList.add('show');
                setTimeout(() => alert.classList.remove('show'), 3000);
            }

            showError(message) {
                const alert = document.getElementById('errorAlert');
                alert.textContent = message || this.translations[this.currentLang]['error'];
                alert.classList.add('show');
                setTimeout(() => alert.classList.remove('show'), 5000);
            }

            updateProgress(percent) {
                const progressBar = document.getElementById('progressBarFill');
                progressBar.style.width = percent + '%';
            }

            bindLanguageEvents() {
                const langBtns = document.querySelectorAll('.lang-btn');
                langBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const lang = e.target.dataset.lang;
                        this.setLanguage(lang);
                    });
                });
            }

            bindHelpEvents() {
                const helpToggle = document.getElementById('helpToggle');
                if (helpToggle) {
                    helpToggle.addEventListener('click', () => {
                        this.toggleHelp();
                    });
                }
            }

            setLanguage(lang) {
                if (this.translations[lang]) {
                    this.currentLang = lang;
                    this.updateLanguage();

                    // Update active button
                    document.querySelectorAll('.lang-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
                }
            }

            updateLanguage() {
                const elements = document.querySelectorAll('[data-i18n]');
                elements.forEach(element => {
                    const key = element.dataset.i18n;
                    if (this.translations[this.currentLang][key]) {
                        if (element.tagName === 'INPUT' && element.type === 'text') {
                            element.placeholder = this.translations[this.currentLang][key];
                        } else {
                            element.innerHTML = this.translations[this.currentLang][key];
                        }
                    }
                });

                // Update static texts that need translation
                this.updateStaticTexts();
            }

            updateStaticTexts() {
                // Update select all label
                const selectAllLabel = document.querySelector('.select-all-label');
                if (selectAllLabel) {
                    selectAllLabel.innerHTML = `<input type="checkbox" id="selectAllCheckbox"> ${this.translations[this.currentLang]['select-all']}`;
                }

                // Update selection count
                const selectionCount = document.getElementById('selectionCount');
                if (selectionCount && selectionCount.textContent.includes('sélectionné')) {
                    const count = this.selectedItems.size;
                    selectionCount.textContent = count + ' ' + this.translations[this.currentLang]['selected-count'];
                }

                // Update buttons
                const moveToStartBtn = document.getElementById('moveSelectedToStartBtn');
                const moveToEndBtn = document.getElementById('moveSelectedToEndBtn');
                const resetBtn = document.getElementById('resetBtn');
                const exportBtn = document.getElementById('exportBtn');

                if (moveToStartBtn) moveToStartBtn.innerHTML = this.translations[this.currentLang]['move-to-start'];
                if (moveToEndBtn) moveToEndBtn.innerHTML = this.translations[this.currentLang]['move-to-end'];
                if (resetBtn) resetBtn.innerHTML = this.translations[this.currentLang]['reset'];
                if (exportBtn) exportBtn.innerHTML = this.translations[this.currentLang]['export'];

                // Update custom type placeholder
                const customTypeInput = document.getElementById('customTypeInput');
                if (customTypeInput) {
                    customTypeInput.placeholder = this.translations[this.currentLang]['custom-type-placeholder'];
                }

                const selectCustomTypeBtn = document.getElementById('selectCustomTypeBtn');
                if (selectCustomTypeBtn) {
                    selectCustomTypeBtn.innerHTML = this.translations[this.currentLang]['select'];
                }
            }

            toggleHelp() {
                const helpContent = document.getElementById('helpContent');
                const helpToggle = document.getElementById('helpToggle');
                const toggleIcon = helpToggle.querySelector('.help-toggle');

                if (helpContent.classList.contains('show')) {
                    helpContent.classList.remove('show');
                    toggleIcon.textContent = '▼';
                } else {
                    helpContent.classList.add('show');
                    toggleIcon.textContent = '▲';
                }
            }

            showPreview() {
                if (!this.pcbdata || !this.pcbdata.bom || !this.pcbdata.bom.both) {
                    this.showError('Aucune donnée BOM disponible pour l\'aperçu');
                    return;
                }

                const previewModal = document.getElementById('previewModal');
                const previewFrame = document.getElementById('previewFrame');
                const previewLoading = document.getElementById('previewLoading');

                // Show loading
                previewFrame.classList.remove('show');
                previewLoading.style.display = 'flex';

                // Show modal
                previewModal.classList.add('show');

                // Generate the modified HTML
                this.generatePreviewHTML().then(previewHTML => {
                    // Hide loading and show iframe
                    previewLoading.style.display = 'none';
                    previewFrame.classList.add('show');

                    // Set the iframe content
                    const blob = new Blob([previewHTML], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    previewFrame.src = url;

                    // Clean up URL when modal is closed
                    previewFrame.onload = () => {
                        URL.revokeObjectURL(url);
                    };
                }).catch(error => {
                    console.error('Error generating preview:', error);
                    this.showError('Erreur lors de la génération de l\'aperçu');
                    this.hidePreview();
                });

                // Add close event listeners
                const previewClose = document.getElementById('previewClose');
                previewClose.onclick = () => this.hidePreview();

                // Add refresh button
                const previewRefresh = document.getElementById('previewRefresh');
                previewRefresh.onclick = () => this.refreshPreview();

                    // Add fullscreen button
                const previewFullscreen = document.getElementById('previewFullscreen');
                previewFullscreen.onclick = () => this.openFullscreenPreview();

                // Setup logo placeholder
                this.setupLogoPlaceholder();

                // Petit délai pour s'assurer que la variable globale est chargée
                setTimeout(() => {
                    // Charger le logo immédiatement si défini globalement (en plus du HTML)
                    if (window.KIR_LOGO_BASE64 && window.KIR_LOGO_BASE64.trim() !== "") {
                        this.setLogoImage(window.KIR_LOGO_BASE64);
                    } else {
                        this.loadSavedLogo();
                    }
                }, 100);

                // Close on backdrop click
                previewModal.onclick = (e) => {
                    if (e.target === previewModal) {
                        this.hidePreview();
                    }
                };

                // Close on Escape key
                document.addEventListener('keydown', this.handlePreviewKeydown);
            }

            hidePreview() {
                const previewModal = document.getElementById('previewModal');
                const previewFrame = document.getElementById('previewFrame');
                const previewLoading = document.getElementById('previewLoading');

                previewModal.classList.remove('show');

                // Clear iframe
                previewFrame.src = 'about:blank';
                previewFrame.classList.remove('show');
                previewLoading.style.display = 'none';

                // Remove event listeners
                document.removeEventListener('keydown', this.handlePreviewKeydown);
            }

            handlePreviewKeydown = (e) => {
                if (e.key === 'Escape') {
                    this.hidePreview();
                }
            }

            setupLogoPlaceholder() {
                const logoPlaceholder = document.getElementById('logoPlaceholder');
                if (logoPlaceholder) {
                    logoPlaceholder.addEventListener('click', () => {
                        // Créer un input file caché
                        const input = document.createElement('input');
                        input.type = 'file';
                        input.accept = 'image/*';
                        input.style.display = 'none';

                        input.addEventListener('change', (e) => {
                            const file = e.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = (event) => {
                                    this.setLogoImage(event.target.result);
                                };
                                reader.readAsDataURL(file);
                            }
                        });

                        document.body.appendChild(input);
                        input.click();
                        document.body.removeChild(input);
                    });
                }
            }

            setLogoImage(imageSrc) {
                const logoPlaceholder = document.getElementById('logoPlaceholder');
                if (logoPlaceholder) {
                    logoPlaceholder.innerHTML = `<img src="${imageSrc}" alt="K.I.R. Logo" style="width: 100%; height: 100%; object-fit: contain; border-radius: 8px;">`;
                    logoPlaceholder.style.border = 'none';
                    logoPlaceholder.style.background = 'transparent';
                    logoPlaceholder.style.cursor = 'default';

                    // Mettre à jour la variable globale
                    window.KIR_LOGO_BASE64 = imageSrc;

                    // Sauvegarder dans le localStorage
                    localStorage.setItem('kir-logo', imageSrc);
                }
            }

            loadSavedLogo() {
                // Priorité : variable globale, puis localStorage
                if (window.KIR_LOGO_BASE64 && window.KIR_LOGO_BASE64.trim() !== "") {
                    this.setLogoImage(window.KIR_LOGO_BASE64);
                } else {
                    const savedLogo = localStorage.getItem('kir-logo');
                    if (savedLogo) {
                        this.setLogoImage(savedLogo);
                    }
                }
            }

            async generatePreviewHTML() {
                if (!this.originalFileContent) {
                    throw new Error('Contenu original non disponible');
                }

                // Compress the modified data
                const jsonString = JSON.stringify(this.pcbdata);
                const compressed = LZString.compressToBase64(jsonString);

                // Replace compressed data in original content
                const previewHTML = this.originalFileContent.replace(
                    /LZString\.decompressFromBase64\("([^"]+)"\)/,
                    'LZString.decompressFromBase64("' + compressed + '")'
                );

                return previewHTML;
            }

            refreshPreview() {
                const previewFrame = document.getElementById('previewFrame');
                const previewLoading = document.getElementById('previewLoading');

                // Show loading
                previewFrame.classList.remove('show');
                previewLoading.style.display = 'flex';

                // Regenerate preview
                this.generatePreviewHTML().then(previewHTML => {
                    previewLoading.style.display = 'none';
                    previewFrame.classList.add('show');

                    const blob = new Blob([previewHTML], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    previewFrame.src = url;

                    previewFrame.onload = () => {
                        URL.revokeObjectURL(url);
                    };
                }).catch(error => {
                    console.error('Error refreshing preview:', error);
                    this.showError('Erreur lors de l\'actualisation de l\'aperçu');
                });
            }

            openFullscreenPreview() {
                this.generatePreviewHTML().then(previewHTML => {
                    // Open in new window
                    const newWindow = window.open('', '_blank');
                    if (newWindow) {
                        newWindow.document.write(previewHTML);
                        newWindow.document.close();
                        this.hidePreview();
                    } else {
                        this.showError('Impossible d\'ouvrir la fenêtre plein écran. Vérifiez les bloqueurs de popups.');
                    }
                }).catch(error => {
                    console.error('Error opening fullscreen preview:', error);
                    this.showError('Erreur lors de l\'ouverture du plein écran');
                });
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new BOMReorder();
        });
    </script>
</body>
</html>
